# see https://github.com/rochus-keller/BUSY/

if busy_version < "2022-09-15" {
	error("this version of BUSY is not compatible with this build")
}
 
submod src

# for clients using the shared lib version of nappgui
let use_nappgui* = src.use_nappgui

# for clients using the static lib version of nappgui
let use_nappgui_static* = src.use_nappgui_static

# build and use the shared library version of nappgui
let shared_all_lib* = src.shared_all_lib

let shared_core_lib* = src.shared_core_lib
let shared_sewer_lib* = src.shared_sewer_lib
let shared_osbs_lib* = src.shared_osbs_lib
let shared_draw2d_lib* = src.shared_draw2d_lib
let shared_geom2d_lib* = src.shared_geom2d_lib
let shared_osgui_lib* = src.shared_osgui_lib
let shared_osapp_lib* = src.shared_osapp_lib
let shared_gui_lib* = src.shared_gui_lib

# build and use the static library version of nappgui
let static_all_lib* = src.static_all_lib

let static_core_lib* = src.static_core_lib
let static_sewer_lib* = src.static_sewer_lib
let static_osbs_lib* = src.static_osbs_lib
let static_draw2d_lib* = src.static_draw2d_lib
let static_geom2d_lib* = src.static_geom2d_lib
let static_osgui_lib* = src.static_osgui_lib
let static_osapp_lib* = src.static_osapp_lib
let static_gui_lib* = src.static_gui_lib

# build and use the nrc utility application of nappgui
let nrc* = src.nrc

let all_libs : Copy {
	.use_deps += [ `shared_lib `static_lib  ]
	.outputs += ./lib/{{source_file_part}}
	if target_os != `win32 {
		# the def files are not complete yet; non-public API is missing
		.deps += [
			shared_core_lib
			shared_sewer_lib
			shared_osbs_lib
			shared_draw2d_lib
			shared_geom2d_lib
			shared_osgui_lib
			shared_osapp_lib
			shared_gui_lib
			]
	}
	.deps += [
		nrc

		shared_all_lib
		
		static_core_lib
		static_sewer_lib
		static_osbs_lib
		static_draw2d_lib
		static_geom2d_lib
		static_osgui_lib
		static_osapp_lib
		static_gui_lib
		static_all_lib
	]
}

# this is the default build which builds everything
let demos ! : Copy {
	.use_deps += `executable;
	.deps += [ all_libs src.demos ]
	.outputs += ./bin/{{source_file_part}}
}



